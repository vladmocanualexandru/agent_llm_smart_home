<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Smart Home Agent</title>
 
</head>
<body>

  <div style="display: flex; margin-top: 10em; width:50%; flex-direction: column; align-items: center; justify-content: center; gap: 20px;">
    <input id="user-input" type="text" placeholder="Type your prompt here..." style="flex: 1; padding: 10px; font-size: 16px; border: 1px solid #ccc; border-radius: 4px;" />
    <button id="send-button" style="margin-left: 10px; padding: 10px 20px; font-size: 16px; background-color: #007BFF; color: white; border: none; border-radius: 4px; cursor: pointer;">Send</button>
  </div>

  <script>
    const userInput = document.getElementById('user-input');
    const sendButton = document.getElementById('send-button');

    const getAgentResponse = (user) => {

      const dry_run = false
      response = fetch('/chat', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({ user, dry_run })
      })
        .then(response => {
          if (!response.ok) {
        throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => data.response)
        .catch(error => {
          console.error('Error:', error);
          return 'Sorry, there was an error processing your request.';
        });

      console.log(response)
      return response 
    };

    // Handle sending a prompt
    const sendPrompt = () => {
      const userPrompt = userInput.value.trim();
      if (!userPrompt) return;

      const agentResponse = getAgentResponse(userPrompt);
      userInput.value = '';
    };

    // Event listeners
    sendButton.addEventListener('click', sendPrompt);
    userInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') sendPrompt();
    });

  </script>

</body>
</html>
